import{s as M,a as T,f as w,D,d as f,c as S,g as v,h as k,j as y,i as u,z as j,o as O,F as E,r as R,u as A,v as C,w as N,G as P,A as L,y as _}from"../chunks/scheduler.aaa74bef.js";import{S as $,i as q,t as h,c as H,a as m,g as J,f as U}from"../chunks/index.26a4f67a.js";/* empty css                       */import{a as g,U as b}from"../chunks/index.eec8b960.js";import{s as V}from"../chunks/index.f25992f7.js";import{s as z}from"../chunks/index.12ffbd6d.js";function F(l){let t,o,e;const s=l[3].default,n=R(s,l,l[2],null);return{c(){t=w("div"),n&&n.c(),this.h()},l(a){t=v(a,"DIV",{class:!0});var r=k(t);n&&n.l(r),r.forEach(f),this.h()},h(){y(t,"class","grow overflow-hidden")},m(a,r){u(a,t,r),n&&n.m(t,null),e=!0},p(a,r){n&&n.p&&(!e||r&4)&&A(n,s,a,a[2],e?N(s,a[2],r,null):C(a[2]),null)},i(a){e||(m(n,a),a&&(o||P(()=>{o=U(t,V,{start:.9,duration:500,opacity:0}),o.start()})),e=!0)},o(a){h(n,a),e=!1},d(a){a&&f(t),n&&n.d(a)}}}function G(l){let t,o='<span class="loading loading-ring loading-lg"></span>';return{c(){t=w("div"),t.innerHTML=o,this.h()},l(e){t=v(e,"DIV",{class:!0,"data-svelte-h":!0}),L(t)!=="svelte-y7ubrx"&&(t.innerHTML=o),this.h()},h(){y(t,"class","grow flex items-center justify-center")},m(e,s){u(e,t,s)},p:_,i:_,o:_,d(e){e&&f(t)}}}function x(l){let t,o,e,s,n;const a=[G,F],r=[];function d(i,c){return i[0]?0:1}return e=d(l),s=r[e]=a[e](l),{c(){t=T(),o=w("main"),s.c(),this.h()},l(i){D("svelte-11dqd79",document.head).forEach(f),t=S(i),o=v(i,"MAIN",{class:!0});var p=k(o);s.l(p),p.forEach(f),this.h()},h(){document.title="App",y(o,"class","h-screen w-screen full-dynamic-viewport-height full-dynamic-viewport-width flex svelte-wv5lwa")},m(i,c){u(i,t,c),u(i,o,c),r[e].m(o,null),n=!0},p(i,[c]){let p=e;e=d(i),e===p?r[e].p(i,c):(J(),h(r[p],1,1,()=>{r[p]=null}),H(),s=r[e],s?s.p(i,c):(s=r[e]=a[e](i),s.c()),m(s,1),s.m(o,null))},i(i){n||(m(s),n=!0)},o(i){h(s),n=!1},d(i){i&&(f(t),f(o)),r[e].d()}}}function B(l,t,o){let e,s;j(l,g,c=>o(1,s=c));let{$$slots:n={},$$scope:a}=t;const r=Date.now();let d=0,i;return O(async()=>{if(await g.verify(),await z(5e3),!(await fetch("/api/stats/app/register-new-page-visit")).ok){const p=await fetch("https://api.ipify.org?format=json"),I=(await p.json()).ip;if(!p.ok||!(await fetch("/api/stats/app/register-new-page-visit-with-ip-param",{method:"POST",body:JSON.stringify({ip:I}),headers:{"Content-Type":"application/json"}})).ok)return}i=setInterval(async()=>{d=Date.now()-r,(await fetch("/api/stats/app/update-page-visit",{method:"POST",body:JSON.stringify({time_spent_seconds:Math.floor(d/1e3)}),headers:{"Content-Type":"application/json"}})).ok||clearInterval(i)},1e3)}),E(()=>clearInterval(i)),l.$$set=c=>{"$$scope"in c&&o(2,a=c.$$scope)},l.$$.update=()=>{if(l.$$.dirty&2&&o(0,e=s===null),l.$$.dirty&2)switch(s){case!1:window.location.href="/login";break;case b.ADMIN:window.location.href="/admin";break;case b.REPORTER:window.location.href="/metrics";break}},[e,s,a,n]}class se extends ${constructor(t){super(),q(this,t,B,x,M,{})}}export{se as component};
