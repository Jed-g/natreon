import{s as I,f as d,a as b,g as _,h as $,A as j,c as k,d as p,j as h,i as m,x as y,y as w,D as H,z as N,o as A,F as P,r as R,u as U,v as V,w as q,G as J}from"../chunks/scheduler.aaa74bef.js";import{S as C,i as D,b as S,d as T,m as O,a as g,t as v,e as E,c as z,g as B,f as F}from"../chunks/index.26a4f67a.js";/* empty css                       */import{a as M,U as x}from"../chunks/index.eec8b960.js";import{s as G}from"../chunks/index.f25992f7.js";import{L as K}from"../chunks/LogoutButton.6acd8598.js";import{s as Q}from"../chunks/index.12ffbd6d.js";function W(l){let e,s,o="Metrics",r,i,c;return i=new K({}),{c(){e=d("div"),s=d("h1"),s.textContent=o,r=b(),S(i.$$.fragment),this.h()},l(t){e=_(t,"DIV",{class:!0});var a=$(e);s=_(a,"H1",{class:!0,"data-svelte-h":!0}),j(s)!=="svelte-1d9v4q0"&&(s.textContent=o),r=k(a),T(i.$$.fragment,a),a.forEach(p),this.h()},h(){h(s,"class","select-none px-4"),h(e,"class","navbar bg-base-100 justify-between")},m(t,a){m(t,e,a),y(e,s),y(e,r),O(i,e,null),c=!0},p:w,i(t){c||(g(i.$$.fragment,t),c=!0)},o(t){v(i.$$.fragment,t),c=!1},d(t){t&&p(e),E(i)}}}class X extends C{constructor(e){super(),D(this,e,null,W,I,{})}}function Y(l){let e,s,o,r,i;s=new X({});const c=l[3].default,t=R(c,l,l[2],null);return{c(){e=d("div"),S(s.$$.fragment),o=b(),t&&t.c(),this.h()},l(a){e=_(a,"DIV",{class:!0});var n=$(e);T(s.$$.fragment,n),o=k(n),t&&t.l(n),n.forEach(p),this.h()},h(){h(e,"class","flex flex-col grow overflow-x-hidden")},m(a,n){m(a,e,n),O(s,e,null),y(e,o),t&&t.m(e,null),i=!0},p(a,n){t&&t.p&&(!i||n&4)&&U(t,c,a,a[2],i?q(c,a[2],n,null):V(a[2]),null)},i(a){i||(g(s.$$.fragment,a),g(t,a),a&&(r||J(()=>{r=F(e,G,{start:.9,duration:500,opacity:0}),r.start()})),i=!0)},o(a){v(s.$$.fragment,a),v(t,a),i=!1},d(a){a&&p(e),E(s),t&&t.d(a)}}}function Z(l){let e,s='<span class="loading loading-ring loading-lg"></span>';return{c(){e=d("div"),e.innerHTML=s,this.h()},l(o){e=_(o,"DIV",{class:!0,"data-svelte-h":!0}),j(e)!=="svelte-y7ubrx"&&(e.innerHTML=s),this.h()},h(){h(e,"class","grow flex items-center justify-center")},m(o,r){m(o,e,r)},p:w,i:w,o:w,d(o){o&&p(e)}}}function ee(l){let e,s,o,r,i;const c=[Z,Y],t=[];function a(n,f){return n[0]?0:1}return o=a(l),r=t[o]=c[o](l),{c(){e=b(),s=d("main"),r.c(),this.h()},l(n){H("svelte-w6ew0j",document.head).forEach(p),e=k(n),s=_(n,"MAIN",{class:!0});var u=$(s);r.l(u),u.forEach(p),this.h()},h(){document.title="Metrics",h(s,"class","h-screen w-screen full-dynamic-viewport-height full-dynamic-viewport-width flex svelte-wv5lwa")},m(n,f){m(n,e,f),m(n,s,f),t[o].m(s,null),i=!0},p(n,[f]){let u=o;o=a(n),o===u?t[o].p(n,f):(B(),v(t[u],1,1,()=>{t[u]=null}),z(),r=t[o],r?r.p(n,f):(r=t[o]=c[o](n),r.c()),g(r,1),r.m(s,null))},i(n){i||(g(r),i=!0)},o(n){v(r),i=!1},d(n){n&&(p(e),p(s)),t[o].d()}}}function te(l,e,s){let o,r;N(l,M,f=>s(1,r=f));let{$$slots:i={},$$scope:c}=e;const t=Date.now();let a=0,n;return A(async()=>{if(await M.verify(),await Q(5e3),!(await fetch("/api/stats/reporter/register-new-page-visit")).ok){const u=await fetch("https://api.ipify.org?format=json"),L=(await u.json()).ip;if(!u.ok||!(await fetch("/api/stats/reporter/register-new-page-visit-with-ip-param",{method:"POST",body:JSON.stringify({ip:L}),headers:{"Content-Type":"application/json"}})).ok)return}n=setInterval(async()=>{a=Date.now()-t,(await fetch("/api/stats/reporter/update-page-visit",{method:"POST",body:JSON.stringify({time_spent_seconds:Math.floor(a/1e3)}),headers:{"Content-Type":"application/json"}})).ok||clearInterval(n)},1e3)}),P(()=>clearInterval(n)),l.$$set=f=>{"$$scope"in f&&s(2,c=f.$$scope)},l.$$.update=()=>{if(l.$$.dirty&2&&s(0,o=r===null),l.$$.dirty&2)switch(r){case!1:window.location.href="/login";break;case x.CUSTOMER:window.location.href="/app";break;case x.ADMIN:window.location.href="/admin";break}},[o,r,c,i]}class ue extends C{constructor(e){super(),D(this,e,te,ee,I,{})}}export{ue as component};
