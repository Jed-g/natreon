import{s as M,a as D,f as w,D as E,d as f,c as O,g as y,h as I,j as g,i as u,z as A,H as N,o as P,F as S,r as R,u as j,v as L,w as C,G as x,A as G,y as h}from"../chunks/scheduler.b2ba2f20.js";import{S as H,i as V,t as m,c as $,a as v,g as q,f as F}from"../chunks/index.4e73caa3.js";import{a as b,U as k}from"../chunks/index.4e6d79c5.js";import{s as J}from"../chunks/index.112fe4a6.js";import{s as U,P as z}from"../chunks/index.17f77d2b.js";import{w as B}from"../chunks/index.1063bc07.js";function K(l){let t,o,e;const s=l[3].default,n=R(s,l,l[2],null);return{c(){t=w("div"),n&&n.c(),this.h()},l(a){t=y(a,"DIV",{class:!0});var r=I(t);n&&n.l(r),r.forEach(f),this.h()},h(){g(t,"class","flex flex-col grow relative overflow-x-hidden")},m(a,r){u(a,t,r),n&&n.m(t,null),e=!0},p(a,r){n&&n.p&&(!e||r&4)&&j(n,s,a,a[2],e?C(s,a[2],r,null):L(a[2]),null)},i(a){e||(v(n,a),a&&(o||x(()=>{o=F(t,J,{start:.9,duration:500,opacity:0}),o.start()})),e=!0)},o(a){m(n,a),e=!1},d(a){a&&f(t),n&&n.d(a)}}}function Q(l){let t,o='<span class="loading loading-ring loading-lg"></span>';return{c(){t=w("div"),t.innerHTML=o,this.h()},l(e){t=y(e,"DIV",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-y7ubrx"&&(t.innerHTML=o),this.h()},h(){g(t,"class","grow flex items-center justify-center")},m(e,s){u(e,t,s)},p:h,i:h,o:h,d(e){e&&f(t)}}}function W(l){let t,o,e,s,n;const a=[Q,K],r=[];function d(i,p){return i[0]?0:1}return e=d(l),s=r[e]=a[e](l),{c(){t=D(),o=w("main"),s.c(),this.h()},l(i){E("svelte-11dqd79",document.head).forEach(f),t=O(i),o=y(i,"MAIN",{class:!0});var c=I(o);s.l(c),c.forEach(f),this.h()},h(){document.title="App",g(o,"class","h-screen w-screen full-dynamic-viewport-height full-dynamic-viewport-width flex svelte-wv5lwa")},m(i,p){u(i,t,p),u(i,o,p),r[e].m(o,null),n=!0},p(i,[p]){let c=e;e=d(i),e===c?r[e].p(i,p):(q(),m(r[c],1,1,()=>{r[c]=null}),$(),s=r[e],s?s.p(i,p):(s=r[e]=a[e](i),s.c()),v(s,1),s.m(o,null))},i(i){n||(v(s),n=!0)},o(i){m(s),n=!1},d(i){i&&(f(t),f(o)),r[e].d()}}}function X(l,t,o){let e,s;A(l,b,c=>o(1,s=c));let{$$slots:n={},$$scope:a}=t;const r=B(null);N("refreshAvatarData",r);const d=Date.now();let i=0,p;return P(async()=>{if(await b.verify(),await U(5e3),!(await fetch("/api/stats/app/register-new-page-visit")).ok){const _=await fetch("https://api.ipify.org?format=json"),T=(await _.json()).ip;if(!_.ok||!(await fetch("/api/stats/app/register-new-page-visit-with-ip-param",{method:"POST",body:JSON.stringify({ip:T}),headers:{"Content-Type":"application/json"}})).ok)return}p=setInterval(async()=>{i=Date.now()-d,(await fetch("/api/stats/app/update-page-visit",{method:"POST",body:JSON.stringify({time_spent_seconds:Math.floor(i/1e3)}),headers:{"Content-Type":"application/json"}})).ok||clearInterval(p)},z)}),S(()=>clearInterval(p)),l.$$set=c=>{"$$scope"in c&&o(2,a=c.$$scope)},l.$$.update=()=>{if(l.$$.dirty&2&&o(0,e=s===null),l.$$.dirty&2)switch(s){case!1:window.location.href="/login";break;case k.ADMIN:window.location.href="/admin";break;case k.REPORTER:window.location.href="/metrics";break}},[e,s,a,n]}class ie extends H{constructor(t){super(),V(this,t,X,W,M,{})}}export{ie as component};
